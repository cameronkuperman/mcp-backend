INFO:apscheduler.scheduler:Adding job tentatively -- it will be properly scheduled when the scheduler starts
INFO:apscheduler.scheduler:Adding job tentatively -- it will be properly scheduled when the scheduler starts
INFO:apscheduler.scheduler:Adding job tentatively -- it will be properly scheduled when the scheduler starts
INFO:apscheduler.scheduler:Adding job tentatively -- it will be properly scheduled when the scheduler starts
INFO:apscheduler.scheduler:Adding job tentatively -- it will be properly scheduled when the scheduler starts
INFO:apscheduler.scheduler:Adding job tentatively -- it will be properly scheduled when the scheduler starts
INFO:apscheduler.scheduler:Adding job tentatively -- it will be properly scheduled when the scheduler starts
INFO:     Started server process [66622]
INFO:     Waiting for application startup.
INFO:run_oracle:Starting Oracle Health API with background scheduler...
WARNING:services.background_jobs:Redis connection failed: Error Multiple exceptions: [Errno 61] Connect call failed ('::1', 6379, 0, 0), [Errno 61] Connect call failed ('127.0.0.1', 6379) connecting to localhost:6379.. Running without cache.
INFO:apscheduler.scheduler:Added job "weekly_ai_predictions_job" to job store "default"
INFO:apscheduler.scheduler:Added job "hourly_ai_predictions_check" to job store "default"
INFO:apscheduler.scheduler:Added job "weekly_health_generation_job" to job store "default"
INFO:apscheduler.scheduler:Added job "cleanup_expired_shares" to job store "default"
INFO:apscheduler.scheduler:Added job "reset_weekly_refresh_limits" to job store "default"
INFO:apscheduler.scheduler:Added job "weekly_intelligence_generation_job" to job store "default"
INFO:apscheduler.scheduler:Added job "weekly_health_score_generation" to job store "default"
INFO:apscheduler.scheduler:Scheduler started
INFO:services.background_jobs:Background job scheduler started
INFO:services.background_jobs:Prediction regeneration service started
INFO:httpx:HTTP Request: POST https://ekaxwbatykostnmopnhn.supabase.co/rest/v1/rpc/regenerate_expired_predictions "HTTP/2 404 Not Found"
ERROR:services.background_predictions:Error checking expired predictions: {'message': 'Could not find the function public.regenerate_expired_predictions without parameters in the schema cache', 'code': 'PGRST202', 'hint': 'Perhaps you meant to call the function public.get_cached_prediction', 'details': 'Searched for the function public.regenerate_expired_predictions without parameters or with a single unnamed json/jsonb parameter, but no matches were found in the schema cache.'}
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
INFO:api.reports.specialist:[ORTHOPEDICS] Request received: analysis_id=cc70d30f-d16e-43f0-adfa-f48f9975c540, user_id=45b61b67-175d-48a0-aca6-d0be57609383
INFO:api.reports.specialist:[ORTHOPEDICS] Quick scan IDs: ['f9c935f0-8140-40d9-9698-3abf2bbaa34b']
INFO:api.reports.specialist:[ORTHOPEDICS] Deep dive IDs: []
INFO:api.reports.specialist:[ORTHOPEDICS] Photo session IDs: []
INFO:httpx:HTTP Request: GET https://ekaxwbatykostnmopnhn.supabase.co/rest/v1/report_analyses?select=%2A&id=eq.cc70d30f-d16e-43f0-adfa-f48f9975c540 "HTTP/2 200 OK"
INFO:utils.data_gathering:=== GATHER_SELECTED_DATA START ===
INFO:utils.data_gathering:User ID: 45b61b67-175d-48a0-aca6-d0be57609383
INFO:utils.data_gathering:Quick scan IDs: ['f9c935f0-8140-40d9-9698-3abf2bbaa34b']
INFO:utils.data_gathering:Deep dive IDs: []
INFO:utils.data_gathering:Photo session IDs: []
INFO:utils.data_gathering:General assessment IDs: []
INFO:utils.data_gathering:General deep dive IDs: []
INFO:httpx:HTTP Request: GET https://ekaxwbatykostnmopnhn.supabase.co/rest/v1/medical?select=%2A&id=eq.45b61b67-175d-48a0-aca6-d0be57609383 "HTTP/2 200 OK"
INFO:utils.data_gathering:Medical profile loaded: True
INFO:utils.data_gathering:Fetching 1 quick scans...
INFO:utils.data_gathering:Quick scan IDs to fetch: ['f9c935f0-8140-40d9-9698-3abf2bbaa34b']
INFO:utils.data_gathering:Quick scan IDs type: <class 'list'>
INFO:utils.data_gathering:User ID for filter: 45b61b67-175d-48a0-aca6-d0be57609383
INFO:httpx:HTTP Request: GET https://ekaxwbatykostnmopnhn.supabase.co/rest/v1/quick_scans?select=id%2Cuser_id&id=in.%28f9c935f0-8140-40d9-9698-3abf2bbaa34b%29 "HTTP/2 200 OK"
INFO:utils.data_gathering:DEBUG - Found 1 quick scans WITHOUT user filter
INFO:utils.data_gathering:DEBUG - User IDs in results: ['45b61b67-175d-48a0-aca6-d0be57609383']
INFO:utils.data_gathering:Converted user_id to string: 45b61b67-175d-48a0-aca6-d0be57609383
INFO:httpx:HTTP Request: GET https://ekaxwbatykostnmopnhn.supabase.co/rest/v1/quick_scans?select=%2A&id=in.%28f9c935f0-8140-40d9-9698-3abf2bbaa34b%29&user_id=eq.45b61b67-175d-48a0-aca6-d0be57609383&order=created_at.asc "HTTP/2 200 OK"
INFO:utils.data_gathering:Found 1 quick scans WITH user filter: True
INFO:utils.data_gathering:Quick scan IDs found: ['f9c935f0-8140-40d9-9698-3abf2bbaa34b']
ERROR:utils.data_gathering:Error in gather_selected_data: 'NoneType' object is not subscriptable
INFO:utils.data_gathering:=== GATHER_SELECTED_DATA SUMMARY ===
INFO:utils.data_gathering:Quick scans: 1
INFO:utils.data_gathering:Deep dives: 0
INFO:utils.data_gathering:General assessments: 0
INFO:utils.data_gathering:General deep dives: 0
INFO:utils.data_gathering:Photo analyses: 0
INFO:utils.data_gathering:Symptom tracking: 0
INFO:utils.data_gathering:LLM summaries: 0
INFO:utils.data_gathering:=== GATHER_SELECTED_DATA END ===
INFO:api.reports.specialist:[ORTHOPEDICS] Data gathered - quick_scans: 1, deep_dives: 0, photo_sessions: 0
INFO:api.reports.specialist:[ORTHOPEDICS] Quick scan IDs found: ['f9c935f0-8140-40d9-9698-3abf2bbaa34b']
INFO:api.reports.specialist:[ORTHOPEDICS] Report generated successfully
INFO:api.reports.specialist:[ORTHOPEDICS] Summary preview: This report details the musculoskeletal assessment for Cameron, a 19-year-old male. While the provided data primarily focuses on a recent oral lesion (Herpes Simplex Virus), there is no specific muscu...
INFO:api.reports.specialist:[ORTHOPEDICS] Key findings: ['No specific musculoskeletal complaints or injuries reported in the provided data.', 'Patient is a 19-year-old male with an active lifestyle (5+ times/week exercise).', 'Reports high stress levels, a potential contributing factor to musculoskeletal issues.', 'Recent diagnosis of Herpes Simplex Virus (cold sores) on Orbicularis Oris, unrelated to orthopedics but noted for overall health context.']
INFO:api.reports.specialist:[ORTHOPEDICS] Chief complaints: ['No orthopedic chief complaint identified from the provided data.']
INFO:api.reports.specialist:[ORTHOPEDICS] Affected joints: []
INFO:api.reports.specialist:[ORTHOPEDICS] Pain location: N/A (no orthopedic pain reported), severity: N/A
INFO:api.reports.specialist:[ORTHOPEDICS] Imaging recommendations: XRays: True, MRI: no
INFO:api.reports.specialist:[ORTHOPEDICS] Oswestry Disability Index: N/A, confidence: 0.0
INFO:httpx:HTTP Request: POST https://ekaxwbatykostnmopnhn.supabase.co/rest/v1/medical_reports "HTTP/2 201 Created"
INFO:api.reports.specialist:[ORTHOPEDICS] Report saved with ID: 028cabfb-d8d4-4fba-8b09-814ec1e315f8
CORS: Allowing origins: ['http://localhost:3000', 'http://localhost:3001', 'http://localhost:3002', 'https://localhost:3000', 'https://localhost:3001', 'https://localhost:3002', 'https://main--flourishing-taiyaki-fd4e09.netlify.app', 'https://flourishing-taiyaki-fd4e09.netlify.app', 'https://proxima-eight-pi.vercel.app', 'https://*.vercel.app', 'https://healthoracle.ai', 'https://www.healthoracle.ai', 'https://app.healthoracle.ai']
CORS: Allowing origins: ['http://localhost:3000', 'http://localhost:3001', 'http://localhost:3002', 'https://localhost:3000', 'https://localhost:3001', 'https://localhost:3002', 'https://main--flourishing-taiyaki-fd4e09.netlify.app', 'https://flourishing-taiyaki-fd4e09.netlify.app', 'https://proxima-eight-pi.vercel.app', 'https://*.vercel.app', 'https://healthoracle.ai', 'https://www.healthoracle.ai', 'https://app.healthoracle.ai']
INFO:     127.0.0.1:58408 - "POST /api/report/orthopedics HTTP/1.1" 200 OK
