# Frontend Implementation Q&A: Physical Category & General Assessment

## 2. Response Format Validation

### Physical Category Response Fields
The response follows the standard format for ALL categories. There are NO physical-specific fields in the response:

```json
{
  "assessment_id": "uuid",
  "analysis": {
    "primary_assessment": "Likely musculoskeletal strain in lower back",
    "confidence": 85,
    "key_findings": [
      "Pain with movement suggests mechanical cause",
      "No red flags for serious pathology"
    ],
    "possible_causes": [
      {"condition": "Muscle strain", "likelihood": 70, "explanation": "Common with sudden movements"},
      {"condition": "Ligament sprain", "likelihood": 20, "explanation": "Possible but less likely"}
    ],
    "recommendations": [
      "Apply ice for first 48 hours",
      "Gentle stretching exercises",
      "Consider physical therapy if no improvement in 1 week"
    ],
    "urgency": "low|medium|high|emergency",
    "follow_up_questions": []
  }
}
```

**Important**: Movement recommendations and PT suggestions go in the general `recommendations` array, not special fields.

### Urgency Indicators for Physical
The standard urgency levels apply, but for physical injuries:
- `emergency`: Suspected fracture, severe trauma, loss of sensation/function
- `high`: Significant pain limiting function, possible nerve involvement
- `medium`: Moderate pain affecting daily activities
- `low`: Minor discomfort, manageable with self-care

## 4. Physical Category Field Validations

### Conditional Field Rules

```javascript
// Validation rules for Physical category
const physicalValidationRules = {
  // affectedSide is relevant for bilateral body parts
  affectedSide: {
    showWhen: (formData) => ['arms', 'legs', 'joints'].includes(formData.bodyRegion),
    required: false
  },
  
  // radiatingPain only for pain issues
  radiatingPain: {
    showWhen: (formData) => formData.issueType === 'pain',
    required: false
  },
  
  // specificMovements always optional but helpful
  specificMovements: {
    showWhen: () => true,
    required: false
  }
};

// Example implementation
const shouldShowAffectedSide = () => {
  return ['arms', 'legs', 'joints'].includes(formData.bodyRegion);
};

const shouldShowRadiatingPain = () => {
  return formData.issueType === 'pain';
};
```

### Required Fields for Physical
- `bodyRegion`: ALWAYS required
- `issueType`: ALWAYS required
- `occurrencePattern`: ALWAYS required
- All other fields are optional

## 5. Body Location Regions Mapping

### Primary bodyRegion Values
YES, these match exactly what the backend expects:
```javascript
const BODY_REGIONS = [
  'head_neck',
  'chest',
  'abdomen', 
  'back',
  'arms',
  'legs',
  'joints',
  'skin',
  'multiple'
];
```

### Optional bodyLocation Field
The `bodyLocation` field is SEPARATE from `bodyRegion`:
- `bodyRegion` (required): High-level category for Physical issues
- `bodyLocation` (optional): More specific location details

```javascript
// For Physical category, you might skip bodyLocation since bodyRegion is specific enough
// But if you want more detail:
{
  bodyRegion: 'back',        // Required Physical field
  bodyLocation: {            // Optional additional detail
    regions: ['lower_back', 'mid_back'],
    description: 'Pain across lower back, worse on left side'
  }
}
```

## 6. Timeline Events

### Physical Category in Timeline
Timeline events are auto-generated by database triggers. Physical assessments appear with:
```javascript
{
  event_type: 'general_quick',      // Same as other general assessments
  event_category: 'general',        // NOT 'body' (that's for 3D scans)
  title: 'General Assessment: physical',
  icon_type: 'zap',                 // Standard for general assessments
  color_scheme: 'emerald'           // Standard for general assessments
}
```

**Display**: Show them the same as other general assessments, but you can display the category name.

## 7. Error Cases

### No Physical-Specific Backend Validation
The backend does NOT enforce special validations. Frontend should handle:

```javascript
// Frontend validation before submission
const validatePhysicalForm = (formData) => {
  const errors = {};
  
  // Required fields
  if (!formData.bodyRegion) {
    errors.bodyRegion = 'Please select the affected body region';
  }
  
  if (!formData.issueType) {
    errors.issueType = 'Please specify the type of issue';
  }
  
  if (!formData.occurrencePattern) {
    errors.occurrencePattern = 'Please indicate when this occurs';
  }
  
  // No invalid combinations - all combinations are valid
  // Backend will handle any combination appropriately
  
  return errors;
};
```

## 10. Form Data Structure

### Correct Deep Dive Request Format

For Physical category, send EXACTLY this structure:

```javascript
// For general assessment
{
  "category": "physical",
  "form_data": {
    // Base fields (all categories)
    "symptoms": "Sharp pain in lower back when bending",
    "duration": "1-2 weeks",
    "impactLevel": 7,
    "aggravatingFactors": ["activity", "poor_sleep"],
    "triedInterventions": ["rest", "otc_medication"],
    
    // Physical-specific fields
    "bodyRegion": "back",
    "issueType": "pain",
    "occurrencePattern": "movement",
    "affectedSide": "left",       // Optional
    "radiatingPain": true,        // Optional
    "specificMovements": "Worse when bending forward",  // Optional
    
    // Optional location detail (usually skip for Physical)
    "bodyLocation": {
      "regions": ["lower_back"],
      "description": "L4-L5 area"
    }
  },
  "user_id": "user-uuid"  // Optional
}

// For deep dive start (same structure)
{
  "category": "physical",
  "form_data": { /* same as above */ },
  "user_id": "user-uuid"
}
```

### Important Notes:
1. **Don't send null values** - Omit optional fields entirely if not used
2. **bodyLocation is usually redundant** for Physical since bodyRegion is specific
3. **All text fields are strings**, numbers for scales only
4. **Arrays for multi-select fields** (aggravatingFactors, triedInterventions)

## Additional Implementation Tips

### 1. Progressive Disclosure
Show fields based on previous selections:
```javascript
{issueType === 'pain' && (
  <RadioGroup label="Does the pain radiate?">
    <Radio value={true}>Yes</Radio>
    <Radio value={false}>No</Radio>
  </RadioGroup>
)}
```

### 2. Help Text
Add contextual help for Physical fields:
```javascript
const FIELD_HELP = {
  occurrencePattern: "When do you notice this issue most?",
  specificMovements: "Describe any movements that trigger or relieve symptoms",
  radiatingPain: "Does the pain spread to other areas?"
};
```

### 3. Smart Defaults
Pre-select common patterns:
```javascript
const PHYSICAL_DEFAULTS = {
  occurrencePattern: 'movement',  // Most physical issues are movement-related
  impactLevel: 5,                 // Mid-scale default
  aggravatingFactors: ['activity'] // Common for physical issues
};
```

### 4. Validation Timing
- Validate required fields on blur
- Validate form on submit
- Don't over-validate optional fields

### 5. Mobile Considerations
- Large tap targets for body region selection
- Collapsible sections for optional fields
- Clear button states for multi-select options